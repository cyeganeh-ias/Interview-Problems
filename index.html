<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/styles/default.min.css"
    />
    <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="icon" type="image/svg+xml" href="./assets/favicon.svg" />
    <link rel="stylesheet" href="./assets/styles.css" />
    <script src="./assets/scripts.js" defer></script>

    <title>Test Page</title>
  </head>
  <body>
    <div class="container">
      <h1>Test page of AppSec Challenges</h1>

      <!-- test 0 -->
      <!-- AWS ID: AKIAIOSFODNN7EXAMPLE -->
      <!-- AWS Key: wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY -->

      <div id="test1" class="container test">
        <h2>Test 1</h2>
        <p>Find the DOM based security vulnerability</p>

        <input onkeyup="test1(event)" value="" placeholder="Value" />

        <div id="test1-out" class="out">-</div>

        <script>
          function test1(e) {
            document.querySelector("#test1-out").innerHTML = e.target.value;
          }
        </script>
      </div>

      <div id="test2" class="container test">
        <h2>Test 2</h2>
        <p></p>

        <script>
          async function test2(e) {}
        </script>
      </div>

      <div id="test3" class="container test">
        <h2>Test 3</h2>
        <p></p>

        <script>
          async function test3(e) {}
        </script>
      </div>

      <div id="test4" class="container test">
        <h2>Test 4</h2>
        <p></p>

        <script>
          async function test4(e) {}
        </script>
      </div>

      <div id="test5" class="container test">
        <h2>Test 5</h2>
        <p></p>

        <pre><code id="test5-fn-sc" class="language-javascript">-</code></pre>
        <script>
          function test5(val) {
            let s = "";
            let [a, b] = [0, 1];
            for (let i = 0; i <= val; i++) {
              s += i + ": " + a + "\n";
              let t = a;
              a = b;
              b = b + t;
            }
            return s;
          }
          document.querySelector("#test5-fn-sc").innerHTML =
            "\n" + test5.toString().replace(/ {10}/g, "");
        </script>
        <input type="number" id="test5-in" value="10" />
        <pre id="test5-out" class="out">-</pre>
        <button
          onclick="document.querySelector('#test5-out').innerHTML =
           test5(parseInt(document.querySelector('#test5-in').value))"
        >
          Run
        </button>
        <button onclick="document.querySelector('#test5-out').innerHTML = '-'">
          Clear
        </button>
      </div>
    </div>

    <script>
      function toggle_sc(id) {
        let elm = document.querySelector(`#${id}`);
        if (elm.style.display === "none") elm.style.display = "block";
        else elm.style.display = "none";
      }
      for (let test_container of document.querySelectorAll(".test")) {
        let test_inner = test_container.innerHTML.replace(/ {8}/g, "");

        let code = document.createElement("code");
        let pre = document.createElement("pre");
        pre.id = `${test_container.id}-sc`;
        pre.style.display = "none";
        code.classList.add("language-html");
        code.textContent = test_inner;
        pre.appendChild(code);

        test_container.appendChild(pre);

        let button = document.createElement("button");
        button.id = `${test_container.id}-sc-btn`;
        button.textContent = "Show Source Code";
        button.addEventListener("click", () =>
          toggle_sc(`${test_container.id}-sc`),
        );
        test_container.appendChild(button);
      }
      hljs.highlightAll();
    </script>
  </body>
</html>
